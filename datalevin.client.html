<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>datalevin.client documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Datalevin</span> <span class="project-version">0.6.16</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="dtlv.html"><div class="inner"><span>Datalevin Command Line Tool</span></div></a></li><li class="depth-1 "><a href="search.html"><div class="inner"><span>Datalevin Search Engine</span></div></a></li><li class="depth-1 "><a href="server.html"><div class="inner"><span>Datalevin Server/Client</span></div></a></li><li class="depth-1 "><a href="upgrade.html"><div class="inner"><span>Datalevin Database Upgrade</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>datalevin</span></div></div></li><li class="depth-2 branch current"><a href="datalevin.client.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>client</span></div></a></li><li class="depth-2 branch"><a href="datalevin.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="datalevin.interpret.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>interpret</span></div></a></li><li class="depth-2"><a href="datalevin.search-utils.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>search-utils</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="datalevin.client.html#var-assign-role"><div class="inner"><span>assign-role</span></div></a></li><li class="depth-1"><a href="datalevin.client.html#var-close-database"><div class="inner"><span>close-database</span></div></a></li><li class="depth-1"><a href="datalevin.client.html#var-create-database"><div class="inner"><span>create-database</span></div></a></li><li class="depth-1"><a href="datalevin.client.html#var-create-role"><div class="inner"><span>create-role</span></div></a></li><li class="depth-1"><a href="datalevin.client.html#var-create-user"><div class="inner"><span>create-user</span></div></a></li><li class="depth-1"><a href="datalevin.client.html#var-disconnect-client"><div class="inner"><span>disconnect-client</span></div></a></li><li class="depth-1"><a href="datalevin.client.html#var-drop-database"><div class="inner"><span>drop-database</span></div></a></li><li class="depth-1"><a href="datalevin.client.html#var-drop-role"><div class="inner"><span>drop-role</span></div></a></li><li class="depth-1"><a href="datalevin.client.html#var-drop-user"><div class="inner"><span>drop-user</span></div></a></li><li class="depth-1"><a href="datalevin.client.html#var-grant-permission"><div class="inner"><span>grant-permission</span></div></a></li><li class="depth-1"><a href="datalevin.client.html#var-list-databases"><div class="inner"><span>list-databases</span></div></a></li><li class="depth-1"><a href="datalevin.client.html#var-list-databases-in-use"><div class="inner"><span>list-databases-in-use</span></div></a></li><li class="depth-1"><a href="datalevin.client.html#var-list-role-permissions"><div class="inner"><span>list-role-permissions</span></div></a></li><li class="depth-1"><a href="datalevin.client.html#var-list-roles"><div class="inner"><span>list-roles</span></div></a></li><li class="depth-1"><a href="datalevin.client.html#var-list-user-permissions"><div class="inner"><span>list-user-permissions</span></div></a></li><li class="depth-1"><a href="datalevin.client.html#var-list-user-roles"><div class="inner"><span>list-user-roles</span></div></a></li><li class="depth-1"><a href="datalevin.client.html#var-list-users"><div class="inner"><span>list-users</span></div></a></li><li class="depth-1"><a href="datalevin.client.html#var-new-client"><div class="inner"><span>new-client</span></div></a></li><li class="depth-1"><a href="datalevin.client.html#var-open-database"><div class="inner"><span>open-database</span></div></a></li><li class="depth-1"><a href="datalevin.client.html#var-query-system"><div class="inner"><span>query-system</span></div></a></li><li class="depth-1"><a href="datalevin.client.html#var-reset-password"><div class="inner"><span>reset-password</span></div></a></li><li class="depth-1"><a href="datalevin.client.html#var-revoke-permission"><div class="inner"><span>revoke-permission</span></div></a></li><li class="depth-1"><a href="datalevin.client.html#var-show-clients"><div class="inner"><span>show-clients</span></div></a></li><li class="depth-1"><a href="datalevin.client.html#var-withdraw-role"><div class="inner"><span>withdraw-role</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">datalevin.client</h1><div class="doc"><div class="markdown"><p>Datalevin client to Datalevin server, blocking API, with a connection pool</p></div></div><div class="public anchor" id="var-assign-role"><h3>assign-role</h3><div class="usage"><code>(assign-role client role-key username)</code></div><div class="doc"><div class="markdown"><p>Assign a role to a user. </p></div></div><div class="src-link"><a href="https://github.com/juji-io/datalevin/blob/master/src/datalevin/client.clj#L413">view source</a></div></div><div class="public anchor" id="var-close-database"><h3>close-database</h3><div class="usage"><code>(close-database client db-name)</code></div><div class="doc"><div class="markdown"><p>Force close a database. Connected clients that are using it will be disconnected.</p>
<p>See <a href="datalevin.client.html#var-disconnect-client">disconnect-client</a></p></div></div><div class="src-link"><a href="https://github.com/juji-io/datalevin/blob/master/src/datalevin/client.clj#L388">view source</a></div></div><div class="public anchor" id="var-create-database"><h3>create-database</h3><div class="usage"><code>(create-database client db-name db-type)</code></div><div class="doc"><div class="markdown"><p>Create a database. <code>db-type</code> can be <code>:datalog</code> or <code>:key-value</code>. <code>db-name</code> will be converted to Kebab case (i.e. all lower case and words connected with dashes).</p></div></div><div class="src-link"><a href="https://github.com/juji-io/datalevin/blob/master/src/datalevin/client.clj#L381">view source</a></div></div><div class="public anchor" id="var-create-role"><h3>create-role</h3><div class="usage"><code>(create-role client role-key)</code></div><div class="doc"><div class="markdown"><p>Create a role. <code>role-key</code> is a keyword.</p></div></div><div class="src-link"><a href="https://github.com/juji-io/datalevin/blob/master/src/datalevin/client.clj#L366">view source</a></div></div><div class="public anchor" id="var-create-user"><h3>create-user</h3><div class="usage"><code>(create-user client username password)</code></div><div class="doc"><div class="markdown"><p>Create a user that can login. <code>username</code> will be converted to Kebab case (i.e. all lower case and words connected with dashes).</p></div></div><div class="src-link"><a href="https://github.com/juji-io/datalevin/blob/master/src/datalevin/client.clj#L345">view source</a></div></div><div class="public anchor" id="var-disconnect-client"><h3>disconnect-client</h3><div class="usage"><code>(disconnect-client client client-id)</code></div><div class="doc"><div class="markdown"><p>Force disconnect a client from the server.</p></div></div><div class="src-link"><a href="https://github.com/juji-io/datalevin/blob/master/src/datalevin/client.clj#L480">view source</a></div></div><div class="public anchor" id="var-drop-database"><h3>drop-database</h3><div class="usage"><code>(drop-database client db-name)</code></div><div class="doc"><div class="markdown"><p>Delete a database. May not be successful if currently in use.</p>
<p>See <a href="datalevin.client.html#var-close-database">close-database</a></p></div></div><div class="src-link"><a href="https://github.com/juji-io/datalevin/blob/master/src/datalevin/client.clj#L396">view source</a></div></div><div class="public anchor" id="var-drop-role"><h3>drop-role</h3><div class="usage"><code>(drop-role client role-key)</code></div><div class="doc"><div class="markdown"><p>Delete a role. <code>role-key</code> is a keyword.</p></div></div><div class="src-link"><a href="https://github.com/juji-io/datalevin/blob/master/src/datalevin/client.clj#L371">view source</a></div></div><div class="public anchor" id="var-drop-user"><h3>drop-user</h3><div class="usage"><code>(drop-user client username)</code></div><div class="doc"><div class="markdown"><p>Delete a user.</p></div></div><div class="src-link"><a href="https://github.com/juji-io/datalevin/blob/master/src/datalevin/client.clj#L356">view source</a></div></div><div class="public anchor" id="var-grant-permission"><h3>grant-permission</h3><div class="usage"><code>(grant-permission client role-key perm-act perm-obj perm-tgt)</code></div><div class="doc"><div class="markdown"><p>Grant a permission to a role.</p>
<p><code>perm-act</code> indicates the permitted action. It can be one of <code>:datalevin.server/view</code>, <code>:datalevin.server/alter</code>, <code>:datalevin.server/create</code>, or <code>:datalevin.server/control</code>, with each subsumes the former.</p>
<p><code>perm-obj</code> indicates the object type of the securable. It can be one of <code>:datalevin.server/database</code>, <code>:datalevin.server/user</code>, <code>:datalevin.server/role</code>, or <code>:datalevin.server/server</code>, where the last one subsumes all the others.</p>
<p><code>perm-tgt</code> indicate the concrete securable target. It can be a database name, a username, or a role key, depending on <code>perm-obj</code>. If it is <code>nil</code>, the permission applies to all securables in that object type.</p></div></div><div class="src-link"><a href="https://github.com/juji-io/datalevin/blob/master/src/datalevin/client.clj#L428">view source</a></div></div><div class="public anchor" id="var-list-databases"><h3>list-databases</h3><div class="usage"><code>(list-databases client)</code></div><div class="doc"><div class="markdown"><p>List all databases.</p></div></div><div class="src-link"><a href="https://github.com/juji-io/datalevin/blob/master/src/datalevin/client.clj#L403">view source</a></div></div><div class="public anchor" id="var-list-databases-in-use"><h3>list-databases-in-use</h3><div class="usage"><code>(list-databases-in-use client)</code></div><div class="doc"><div class="markdown"><p>List databases that are in use.</p></div></div><div class="src-link"><a href="https://github.com/juji-io/datalevin/blob/master/src/datalevin/client.clj#L408">view source</a></div></div><div class="public anchor" id="var-list-role-permissions"><h3>list-role-permissions</h3><div class="usage"><code>(list-role-permissions client role-key)</code></div><div class="doc"><div class="markdown"><p>List the permissions granted to a role.</p>
<p>See <a href="datalevin.client.html#var-grant-permission">grant-permission</a>.</p></div></div><div class="src-link"><a href="https://github.com/juji-io/datalevin/blob/master/src/datalevin/client.clj#L456">view source</a></div></div><div class="public anchor" id="var-list-roles"><h3>list-roles</h3><div class="usage"><code>(list-roles client)</code></div><div class="doc"><div class="markdown"><p>List all roles.</p></div></div><div class="src-link"><a href="https://github.com/juji-io/datalevin/blob/master/src/datalevin/client.clj#L376">view source</a></div></div><div class="public anchor" id="var-list-user-permissions"><h3>list-user-permissions</h3><div class="usage"><code>(list-user-permissions client username)</code></div><div class="doc"><div class="markdown"><p>List the permissions granted to a user through the roles assigned.</p></div></div><div class="src-link"><a href="https://github.com/juji-io/datalevin/blob/master/src/datalevin/client.clj#L463">view source</a></div></div><div class="public anchor" id="var-list-user-roles"><h3>list-user-roles</h3><div class="usage"><code>(list-user-roles client username)</code></div><div class="doc"><div class="markdown"><p>List the roles assigned to a user. </p></div></div><div class="src-link"><a href="https://github.com/juji-io/datalevin/blob/master/src/datalevin/client.clj#L423">view source</a></div></div><div class="public anchor" id="var-list-users"><h3>list-users</h3><div class="usage"><code>(list-users client)</code></div><div class="doc"><div class="markdown"><p>List all users.</p></div></div><div class="src-link"><a href="https://github.com/juji-io/datalevin/blob/master/src/datalevin/client.clj#L361">view source</a></div></div><div class="public anchor" id="var-new-client"><h3>new-client</h3><div class="usage"><code>(new-client uri-str)</code><code>(new-client uri-str {:keys [pool-size time-out], :or {pool-size c/connection-pool-size, time-out c/connection-timeout}})</code></div><div class="doc"><div class="markdown"><p>Create a new client that maintains pooled connections to a remote Datalevin database server. This operation takes at least 0.5 seconds in order to perform a secure password hashing that defeats cracking.</p>
<p>Fields in the <code>uri-str</code> should be properly URL encoded, e.g. user and password need to be URL encoded if they contain special characters.</p>
<p>The following can be set in the optional map: * <code>:pool-size</code> determines number of connections maintained in the connection pool, default is 5. * <code>:time-out</code> specifies the time (milliseconds) before an exception is thrown when obtaining an open network connection, default is 60000.</p></div></div><div class="src-link"><a href="https://github.com/juji-io/datalevin/blob/master/src/datalevin/client.clj#L303">view source</a></div></div><div class="public anchor" id="var-open-database"><h3>open-database</h3><div class="usage"><code>(open-database client db-name db-type)</code><code>(open-database client db-name db-type opts)</code><code>(open-database client db-name db-type schema opts)</code></div><div class="doc"><div class="markdown"><p>Open a database on server. <code>db-type</code> can be “datalog” or “kv”</p></div></div><div class="src-link"><a href="https://github.com/juji-io/datalevin/blob/master/src/datalevin/client.clj#L286">view source</a></div></div><div class="public anchor" id="var-query-system"><h3>query-system</h3><div class="usage"><code>(query-system client query &amp; arguments)</code></div><div class="doc"><div class="markdown"><p>Issue arbitrary Datalog query to the system database on the server. Note that unlike <code>q</code> function, the arguments here should NOT include db, as the server will supply it.</p></div></div><div class="src-link"><a href="https://github.com/juji-io/datalevin/blob/master/src/datalevin/client.clj#L468">view source</a></div></div><div class="public anchor" id="var-reset-password"><h3>reset-password</h3><div class="usage"><code>(reset-password client username password)</code></div><div class="doc"><div class="markdown"><p>Reset a user’s password.</p></div></div><div class="src-link"><a href="https://github.com/juji-io/datalevin/blob/master/src/datalevin/client.clj#L351">view source</a></div></div><div class="public anchor" id="var-revoke-permission"><h3>revoke-permission</h3><div class="usage"><code>(revoke-permission client role-key perm-act perm-obj perm-tgt)</code></div><div class="doc"><div class="markdown"><p>Revoke a permission from a role.</p>
<p>See <a href="datalevin.client.html#var-grant-permission">grant-permission</a>.</p></div></div><div class="src-link"><a href="https://github.com/juji-io/datalevin/blob/master/src/datalevin/client.clj#L448">view source</a></div></div><div class="public anchor" id="var-show-clients"><h3>show-clients</h3><div class="usage"><code>(show-clients client)</code></div><div class="doc"><div class="markdown"><p>Show information about the currently connected clients on the server.</p></div></div><div class="src-link"><a href="https://github.com/juji-io/datalevin/blob/master/src/datalevin/client.clj#L475">view source</a></div></div><div class="public anchor" id="var-withdraw-role"><h3>withdraw-role</h3><div class="usage"><code>(withdraw-role client role-key username)</code></div><div class="doc"><div class="markdown"><p>Withdraw a role from a user. </p></div></div><div class="src-link"><a href="https://github.com/juji-io/datalevin/blob/master/src/datalevin/client.clj#L418">view source</a></div></div></div></body></html>